<!DOCTYPE html>
<html lang="kor">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>date</title>

    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet" />
    <link href="../assets/jq/jquery-ui.css" type="text/css" media="all" rel="stylesheet" />

    <script src="../assets/jq/jquery-3.7.1.min.js"></script>
    <script src="../assets/jq/jquery-ui.js"></script>
  </head>

  <style>
    * {
      padding: 0;
      margin: 0;
      box-sizing: content-box;
    }
    .wrap {
      margin: 100px;
    }
    .ui-datepicker {
      width: 400px;
    }
  </style>
  <body>
    <div class="wrap">
      <p style="margin-top: 20px">Date: <input type="text" id="datepickerIP" /></p>

      <div style="margin-top: 20px" id="mydate"></div>

      <div class="sid">
        <span class="a1"></span>
        <span class="a2"></span>
        <span class="a3"></span>
        <span class="a4"></span>
        <span class="a5"></span>
      </div>
    </div>
  </body>

  <!-- <div id="document_wrap">
    <header>
      <div class="top_wrap">
        <div class="top_bar">
          본 예제는 <a href="https://blog.munilive.com" target="_blank">https://blog.munilive.com</a>에서 제공하는 예제 입니다. |
          <a href="/posts/datepicker-start-date-end-date-on-use-good-tips.html">관련 글 바로가기</a>
        </div>
      </div>
    </header>
    <div id="layout_google_ad_post_header" style="margin: auto">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle" style="display: block" data-ad-client="ca-pub-8023728802418443" data-ad-slot="4899865412" data-ad-format="auto"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
    <div id="content_box">
      <h1>Javascript Example: datepicker 시작일 종료일 설정 - 예제2</h1>
      <link rel="stylesheet" href="//code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
      <script src="//code.jquery.com/jquery-1.9.1.js"></script>
      <script src="//code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
      <script>
        $(document).ready(function () {
          ($.datepicker.regional.ko = {
            closeText: "\ub2eb\uae30",
            prevText: "\uc774\uc804\ub2ec",
            nextText: "\ub2e4\uc74c\ub2ec",
            currentText: "\uc624\ub298",
            monthNames: [
              "1\uc6d4(JAN)",
              "2\uc6d4(FEB)",
              "3\uc6d4(MAR)",
              "4\uc6d4(APR)",
              "5\uc6d4(MAY)",
              "6\uc6d4(JUN)",
              "7\uc6d4(JUL)",
              "8\uc6d4(AUG)",
              "9\uc6d4(SEP)",
              "10\uc6d4(OCT)",
              "11\uc6d4(NOV)",
              "12\uc6d4(DEC)",
            ],
            monthNamesShort: [
              "1\uc6d4",
              "2\uc6d4",
              "3\uc6d4",
              "4\uc6d4",
              "5\uc6d4",
              "6\uc6d4",
              "7\uc6d4",
              "8\uc6d4",
              "9\uc6d4",
              "10\uc6d4",
              "11\uc6d4",
              "12\uc6d4",
            ],
            dayNames: ["\uc77c", "\uc6d4", "\ud654", "\uc218", "\ubaa9", "\uae08", "\ud1a0"],
            dayNamesShort: ["\uc77c", "\uc6d4", "\ud654", "\uc218", "\ubaa9", "\uae08", "\ud1a0"],
            dayNamesMin: ["\uc77c", "\uc6d4", "\ud654", "\uc218", "\ubaa9", "\uae08", "\ud1a0"],
            weekHeader: "Wk",
            dateFormat: "yy-mm-dd",
            firstDay: 0,
            isRTL: !1,
            showMonthAfterYear: !0,
            yearSuffix: "",
            showOn: "both",
            buttonText: "\ub2ec\ub825",
            changeMonth: !0,
            changeYear: !0,
            showButtonPanel: !0,
            yearRange: "c-99:c+99",
          }),
            $.datepicker.setDefaults($.datepicker.regional.ko);
          var e = new Date(),
            t = new Date(),
            a = e.getMonth() + 1,
            o = e.getDate();
          (a = a < 10 ? "0" + a : a), (o = o < 10 ? "0" + o : o);
          var n = e.getFullYear() + "-" + a + "-" + o;
          t.setDate(e.getDate() - 7);
          var d = t.getMonth() + 1,
            r = t.getDate();
          (d = d < 10 ? "0" + d : d), (r = r < 10 ? "0" + r : r);
          var i = t.getFullYear() + "-" + d + "-" + r;
          $("#sdate").val(i),
            $("#edate").val(n),
            $("#sdate").datepicker(),
            $("#sdate").datepicker("option", "maxDate", $("#edate").val()),
            $("#sdate").datepicker("option", "onClose", function (e) {
              $("#edate").datepicker("option", "minDate", e), $("#edate").val(e);
            }),
            $("#edate").datepicker(),
            $("#edate").datepicker("option", "minDate", $("#sdate").val()),
            $("#edate").datepicker("option", "beforeShow", function () {
              var e = $("#sdate").val().split("-");
              e[1] = e[1] - 1;
              var t = new Date(e[0], e[1], e[2]),
                a = new Date(e[0], e[1], e[2]);
              a.setDate(t.getDate() + 7), $("#edate").datepicker("option", "maxDate", a);
            }),
            $("#edate").datepicker("option", "onClose", function (e) {
              $("#sdate").datepicker("option", "maxDate", e);
            });
        });
      </script>
      <form name="frmEX">
        시작일 : <input type="text" name="sdate" id="sdate" size="10" maxlength="10" value="" /> ~ 종료일 :
        <input type="text" name="edate" id="edate" size="10" maxlength="10" value="" /><br />
        시작일은 종료일 이후 날짜를 선택 할 수 없으며, 종료일은 시작일 이전의 날짜를 선택 할 수 없습니다.<br />
        날짜를 변경하면 자동으로 시작일과 종료일의 선택가능 날짜가 변경됩니다.<br />
        ※ 시작일과 종료일 input box에 초기 날짜 입력을 기존 PHP date()함수를 이용하여 출력하던 것을 javascript를 이용하여 출력하도록 변경하였고, 종료일 선택시
        종료일을 선택 할 수 있는 최대 범위를 시작일 +7일로 하는 내용을 추가 하였습니다.<br />
      </form>
    </div>
    <div id="layout_google_ad_post_footer">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle" style="display: block" data-ad-client="ca-pub-8023728802418443" data-ad-slot="8501294615" data-ad-format="auto"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
    <footer>
      <div class="footer_message">
        본 예제는 <a href="https://blog.munilive.com" target="_blank">https://blog.munilive.com</a>에서 제공하는 예제 입니다. |
        <a href="/posts/datepicker-start-date-end-date-on-use-good-tips.html">관련 글 바로가기</a>
      </div>
      <div class="copy_right">Copyright © 2023 Second Memory</div>
    </footer>
  </div> -->

  <script>
    let fdate;
    let sdate;
    let findate = [20231120, 20231101];
    let disabledDates = ["2023-11-22", "2023-11-25", "2023-11-30"];

    $(function () {
      //input을 datepicker로 선언
      $("#datepickerIP").datepicker({
        dateFormat: "yy-mm-dd", //Input Display Format 변경
        showOtherMonths: true, //빈 공간에 현재월의 앞뒤월의 날짜를 표시
        showMonthAfterYear: true, //년도 먼저 나오고, 뒤에 월 표시
        changeYear: true, //콤보박스에서 년 선택 가능
        changeMonth: true, //콤보박스에서 월 선택 가능
        showOn: "both", //button:버튼을 표시하고,버튼을 눌러야만 달력 표시 ^ both:버튼을 표시하고,버튼을 누르거나 input을 클릭하면 달력 표시
        buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif", //버튼 이미지 경로
        buttonImageOnly: true, //기본 버튼의 회색 부분을 없애고, 이미지만 보이게 함
        buttonText: "선택", //버튼에 마우스 갖다 댔을 때 표시되는 텍스트
        yearSuffix: "년", //달력의 년도 부분 뒤에 붙는 텍스트
        monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"], //달력의 월 부분 텍스트
        monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"], //달력의 월 부분 Tooltip 텍스트
        dayNamesMin: ["일", "월", "화", "수", "목", "금", "토"], //달력의 요일 부분 텍스트
        dayNames: ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"], //달력의 요일 부분 Tooltip 텍스트
        minDate: "1", //최소 선택일자(-1D:하루전, -1M:한달전, -1Y:일년전)
        maxDate: "+10D", //최대 선택일자(+1D:하루후, -1M:한달후, -1Y:일년후)
        // Type: Function
        // onSelect: function (dateText, inst) {
        //   console.log(dateText);
        // },

        // onChangeMonthYear: function() {
        //   console.log("onChangeMonthYear");
        // },
        // onClose: function() {
        //   console.log("onClose");
        // },
        // onUpdateDatepicker: function() {
        //   console.log("onUpdateDatepicker");
        // },
        // beforeShow: function() {
        //   console.log("beforeShow");
        // },
        // calculateWeek: function() {
        //   console.log("calculateWeek");
        // },
        beforeShowDay: function (date) {
          // var dateString = $.datepicker.formatDate("yy-mm-dd", date);
          // if (disabledDates.indexOf(dateString) != -1) {
          //   return [false];
          // } else {
          //   return [true];
          // }
          

          // 예약된 날짜는 선택 불가능하게 설정
          var formattedDate = $.datepicker.formatDate("yy-mm-dd", date);

          // return [disabledDates.indexOf(formattedDate) === -1]; // 예약된 날짜는 선택 불가능하게 설정

          
          if (disabledDates.indexOf(formattedDate) !== -1) {
            return [false, "reserved-date"]; // reserved-date 클래스 적용
          } else {
            return [true, ""];
          }
        },
        onSelect: function (d) {
          //-------------------------여기까지가 달력형태로 만든 후 클릭했을 때를 설정해주는 부분이야
          //-------------------------여기서부터는 선택한 날짜를 잘라서 각각의 요소에 넣어주는 부분이야
          // alert("d = " + d);

          // var arr = d.split("/");

          // $("#year").text(arr[0].trim());
          // $("#month").text(arr[1].trim());
          // $("#day").text(arr[2].trim());

          //-------------------------가져온 날짜를 Date Class 에 넣어주는 부분이야
          // let date = new Date($("#datepickerIP").datepicker({ dataFormat: "yy/mm/dd" }).val());
          let date = new Date($("#datepickerIP").datepicker("getDate"));
          let day = date.getDate();
          let month = date.getMonth() + 1;
          let year = date.getFullYear();
          day = day < 10 ? `0${day}` : day;
          month = month < 10 ? `0${month}` : month;
          sdate = `${year}${month}${day}` * 1;
          // alert("요일번호:" + date.getDay());
          // 선택한 날짜의 요일 번호를 가져와서 무슨 요일인지 알아보려는거야
          let week = new Array("일", "월", "화", "수", "목", "금", "토");
          // $("#mydate").text(week[date.getDay()]);
          $("#mydate").text(sdate);
          // console.log(sdate);
          // console.log("result");
          // console.log(sdate - fdate);
          // console.log("array");
          // console.log(findate[0] - sdate);

          // 예약날짜 비교
          let len = [];
          let loop;
          let reDate = ["2023.11.19", "2023.11.20", "2023.11.27", "2023.11.30", "2023.12.05", "2023.12.29"];
          console.log(`reDate : ${reDate}`);
          for (const item of reDate) {
            let nd = new Date(item);
            let v = (nd - date) / 86400000;
            if (v > 0 && v <= 15) {
              len.push(v);
            }
          }

          console.log("----------------");
          console.log(len);
          // console.log(len.length);
          // loop 설정 len.length === 0 일때 최대값 노출
          if (len.length === 0) {
            len.push(15);
          }
          // console.log(typeof(len[0]));
          loop = len[0];

          for (let i = 1; i <= loop; i++) {
            console.log(i);
          }
        },
      });
      // $("#datepickerBB").datepicker();

      //From의 초기값을 오늘 날짜로 설정
      $("#datepickerIP").datepicker("setDate", "+1D"); //(-1D:하루전, -1M:한달전, -1Y:일년전), (+1D:하루후, -1M:한달후, -1Y:일년후)
    });

    // ~  반환
    function result() {
      let tarray = [1, 2, 3, 4, 5, 6, 10, 12, 14, 20, 21, 22, 23, 25, 26, 28, 29];
      let newArray = [];
      let outArray = [];
      let cntn = 0;
      // arr[5][2] (빈 배열 생성)
      const tarr1 = Array.from(Array(tarray.length), () => new Array(0));
      // arr[5][2] (null로 초기화하여 생성)
      // const tarr2 = Array.from(Array(5), () => Array(2).fill(null));
      for (let i = 0; i < tarray.length - 1; i++) {
        // if (tarray[i] + 1 != tarray[i + 1]) return "NO";
        // console.log(tarray[i] + 1 === tarray[i + 1]);
        // if (tarray[i] + 1 != tarray[i + 1]) {
        //   tarray[i] = "/"
        // }
        if (tarray[i] + 1 === tarray[i + 1]) {
          if (tarr1[cntn].includes("/")) {
            cntn += 1;
          }
          tarr1[cntn].push(tarray[i]);
        } else {
          cntn += 1;
          if (tarray[i] - 1 === tarray[i - 1]) {
            // tarr1[cntn].push(tarray[i]);
          } else {
            tarr1[cntn].push("/");
            tarr1[cntn].push(tarray[i]);
          }
        }
      }
      console.log(tarray);
      console.log(tarr1);
      console.log("--------------");
      // console.log(newArray);
      // console.log(tarr1);
      // return "YES";
      // for (let j = 0; j < newArray.length - 1; j++) {
      //   if (newArray[j] + 1 === newArray[j + 1]) {
      //     outArray.push(newArray[j]);
      //   }
      // }
      // console.log(outArray);

      for (const item of tarr1) {
        let out;
        let max = item[item.length - 1] + 1;
        if (item.length >= 1 && !item.includes("/")) {
          out = `${item[0]} ~ ${max}`;
        } else {
          out = `${item[1]}`;
        }
        // console.log(out);
        if (!out.includes(undefined)) {
          console.log(out);
        }
        // if (out.indexOf(undefined) != -1) {
        //   console.log(out);
        // }
      }
    }
    result();

    // 토요일, 일요일은 선택이 안되도록 또는 특정일자는 선택이 안돼도록 설정할 수 있습니다.
    // 아래 예제 소스에서 굵은 글자로 표시된 부분을 참조해주세요.
    // beforeShowDay 값에 해당 일자의 표시여부를 판단하는 함수를 적어주시면 됩니다.
    // 각 상황별 함수는 그 아래에 첨부하였습니다.

    $("#input4").datepicker({
      showOn: "button",
      buttonImage: "<?=$g4[path]?>/img/calendar.gif",
      buttonImageOnly: true,
      buttonText: "달력",
      changeMonth: true,
      changeYear: true,
      showButtonPanel: true,
      yearRange: "c-99:c+99",
      minDate: "+1d",
      maxDate: "+100d",
      beforeShowDay: noSundays,
    });

    // 특정날짜들 배열
    var disabledDays = ["2013-7-9", "2013-7-24", "2013-7-26"];

    // 주말(토, 일요일) 선택 막기
    function noWeekendsOrHolidays(date) {
      var noWeekend = jQuery.datepicker.noWeekends(date);
      return noWeekend[0] ? [true] : noWeekend;
    }

    // 일요일만 선택 막기
    function noSundays(date) {
      return [date.getDay() != 0, ""];
    }

    // 이전 날짜들은 선택막기
    function noBefore(date) {
      if (date < new Date()) return [false];
      return [true];
    }
    // 특정일 선택막기
    function disableAllTheseDays(date) {
      var m = date.getMonth(),
        d = date.getDate(),
        y = date.getFullYear();
      for (i = 0; i < disabledDays.length; i++) {
        if ($.inArray(y + "-" + (m + 1) + "-" + d, disabledDays) != -1) {
          return [false];
        }
      }
      return [true];
    }
  </script>
</html>
